# Async FastAPI Template

A starter kit for building production-grade, asynchronous FastAPI services with SQLAlchemy, Pydantic, Alembic, testing, and Docker.

---

## ğŸ“ Repository Layout

```text
â”œâ”€â”€ .gitignore                   # ignores venv, pyc, logs, .env
â”œâ”€â”€ .dockerignore                # ignores files in Docker builds
â”œâ”€â”€ .env.example                 # example env vars for local dev
â”œâ”€â”€ alembic.ini                  # Alembic config
â”œâ”€â”€ Dockerfile                   # **(add this)** multi-stage build for the app
â”œâ”€â”€ docker-entrypoint.sh         # **(add this)** waits for Postgres & runs migrations
â”œâ”€â”€ docker-compose.yml           # **(add this)** bring up your app + Postgres
â”œâ”€â”€ pytest.ini                   # pytest settings & warning filters
â”œâ”€â”€ requirements.txt             # pinned dependencies (or pyproject.toml)
â”œâ”€â”€ Readme.md                    # this document
â”‚
â”œâ”€â”€ alembic/                     # migration folder (autoâ€generated by `alembic init`)
â”‚   â”œâ”€â”€ env.py                   # imports your models via app/db/base.py
â”‚   â””â”€â”€ versions/                # auto-generated revision scripts
â”‚
â”œâ”€â”€ app/                         # your application code
â”‚   â”œâ”€â”€ main.py                  # creates FastAPI app, mounts routers, sets up logging
â”‚   â”‚
â”‚   â”œâ”€â”€ core/                    # cross-cutting modules
â”‚   â”‚   â”œâ”€â”€ config.py            # pydanticâ€settings `Settings` (DATABASE_URL, etc.)
â”‚   â”‚   â”œâ”€â”€ logger.py            # structured logging setup (console & file/rotation)
â”‚   â”‚   â””â”€â”€ security.py          # JWT password hashing, OAuth2 schemes, etc.
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                     # HTTP layer
â”‚   â”‚   â””â”€â”€ routes/              
â”‚   â”‚       â””â”€â”€ users.py         # `@router.post("/"), @router.get("/")`, etc.
â”‚   â”‚
â”‚   â””â”€â”€ db/                      # persistence layer
â”‚       â”œâ”€â”€ base_class.py        # single `class Base(DeclarativeBase)`
â”‚       â”œâ”€â”€ base.py              # imports every model so Alembic sees them
â”‚       â”œâ”€â”€ session.py           # AsyncEngine + `get_db()` dependency
â”‚       â”œâ”€â”€ models/              # SQLAlchemy ORM models
â”‚       â”‚   â””â”€â”€ user.py
â”‚       â”œâ”€â”€ schemas/             # Pydantic request/response schemas
â”‚       â”‚   â””â”€â”€ user.py
â”‚       â””â”€â”€ curd/                # â€œCRUDâ€ operations in small modules
â”‚           â””â”€â”€ user.py
â”‚
â”œâ”€â”€ config/                      # environment files by stage
â”‚   â””â”€â”€ dev.env                  # `.env` for local dev
â”‚
â”œâ”€â”€ logs/                        # rotating app logs (ignored in Git)
â”‚   â””â”€â”€ app.log
â”‚
â””â”€â”€ tests/                       # pytest suite
    â”œâ”€â”€ conftest.py             # overrides, DB bootstrap fixtures
    â””â”€â”€ test_users.py           # basic CRUD & validation tests
```


---

## ğŸš€ Getting Started

1. **Install dependencies**
   ```sh
   pip install -r requirements.txt
   ```

2. **Generate & apply database migrations**
   ```sh
# Initialize Alembic (if you haven't already):
alembic init alembic

# Create a new revision based on your models:
alembic revision --autogenerate -m "Initial tables"

# Apply migrations to your dev database:
alembic upgrade head
```

3. **Start the app**
   ```sh
   uvicorn app.main:app --reload
   ```

4. **Run tests**
   ```sh
   pytest -v
   ```

5. **View code coverage**
   ```sh
   pytest --cov=app --cov-report=term-missing
   ```

6. **Dockerize & launch with Docker Compose **
  ```sh
    docker-compose up --build
  ```
