# Async FastAPI Template

A starter kit for building production-grade, asynchronous FastAPI services with SQLAlchemy, Pydantic, Alembic, testing, and Docker.

---

## 📁 Repository Layout

```text
├── .gitignore                   # ignores venv, pyc, logs, .env
├── .dockerignore                # ignores files in Docker builds
├── .env.example                 # example env vars for local dev
├── alembic.ini                  # Alembic config
├── Dockerfile                   # **(add this)** multi-stage build for the app
├── docker-entrypoint.sh         # **(add this)** waits for Postgres & runs migrations
├── docker-compose.yml           # **(add this)** bring up your app + Postgres
├── pytest.ini                   # pytest settings & warning filters
├── requirements.txt             # pinned dependencies (or pyproject.toml)
├── Readme.md                    # this document
│
├── alembic/                     # migration folder (auto‐generated by `alembic init`)
│   ├── env.py                   # imports your models via app/db/base.py
│   └── versions/                # auto-generated revision scripts
│
├── app/                         # your application code
│   ├── main.py                  # creates FastAPI app, mounts routers, sets up logging
│   │
│   ├── core/                    # cross-cutting modules
│   │   ├── config.py            # pydantic‐settings `Settings` (DATABASE_URL, etc.)
│   │   ├── logger.py            # structured logging setup (console & file/rotation)
│   │   └── security.py          # JWT password hashing, OAuth2 schemes, etc.
│   │
│   ├── api/                     # HTTP layer
│   │   └── routes/              
│   │       └── users.py         # `@router.post("/"), @router.get("/")`, etc.
│   │
│   └── db/                      # persistence layer
│       ├── base_class.py        # single `class Base(DeclarativeBase)`
│       ├── base.py              # imports every model so Alembic sees them
│       ├── session.py           # AsyncEngine + `get_db()` dependency
│       ├── models/              # SQLAlchemy ORM models
│       │   └── user.py
│       ├── schemas/             # Pydantic request/response schemas
│       │   └── user.py
│       └── curd/                # “CRUD” operations in small modules
│           └── user.py
│
├── config/                      # environment files by stage
│   └── dev.env                  # `.env` for local dev
│
├── logs/                        # rotating app logs (ignored in Git)
│   └── app.log
│
└── tests/                       # pytest suite
    ├── conftest.py             # overrides, DB bootstrap fixtures
    └── test_users.py           # basic CRUD & validation tests
```


---

## 🚀 Getting Started

1. **Install dependencies**
   ```sh
   pip install -r requirements.txt
   ```

2. **Generate & apply database migrations**
   ```sh
# Initialize Alembic (if you haven't already):
alembic init alembic

# Create a new revision based on your models:
alembic revision --autogenerate -m "Initial tables"

# Apply migrations to your dev database:
alembic upgrade head
```

3. **Start the app**
   ```sh
   uvicorn app.main:app --reload
   ```

4. **Run tests**
   ```sh
   pytest -v
   ```

5. **View code coverage**
   ```sh
   pytest --cov=app --cov-report=term-missing
   ```

6. **Dockerize & launch with Docker Compose **
  ```sh
    docker-compose up --build
  ```
