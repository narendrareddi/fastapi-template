# Async FastAPI Template

A modern, production-ready template for building asynchronous FastAPI services with SQLAlchemy, Alembic migrations, Pydantic settings, and a robust testing setup.

---

## 📁 Folder Structure

```
fastapi_async/
│
├── alembic/                # Alembic migration scripts and env config
│   └── versions/           # Auto-generated migration files
│
├── app/
│   ├── api/                # API routers/endpoints (e.g., users)
│   │   └── routes/         # Route modules for each resource
│   ├── core/               # Core utilities (config, logging, etc.)
│   │   ├── config.py       # Pydantic-based app settings and DB URL assembly
│   │   └── logger.py       # Logging configuration for the app
│   ├── db/                 # Database models, session, and base
│   ├── main.py             # FastAPI app instance and startup logic
│   └── ...                 # (Other modules: schemas, services, etc.)
│
├── config/
│   └── dev.env             # Environment variables for local development
│
├── tests/                  # All test code
│   ├── conftest.py         # Pytest fixtures (test client, DB setup/teardown)
│   └── test_users.py       # Example test cases for user endpoints
│
├── requirements.txt        # Python dependencies
├── README.md               # Project documentation (this file)
└── ...
```

---

## 📦 Module Importance

- **alembic/**  
  Handles all database schema migrations. The `versions/` folder contains migration scripts generated by Alembic.  
  *Why?* Ensures your database schema stays in sync with your models across all environments.

- **app/core/config.py**  
  Centralizes configuration using Pydantic. Loads environment variables, assembles async/sync DB URLs, and provides a single source of truth for app settings.  
  *Why?* Keeps configuration DRY, secure, and easy to manage.

- **app/core/logger.py**  
  Sets up structured logging for the entire application.  
  *Why?* Ensures consistent and informative logs for debugging and monitoring.

- **app/main.py**  
  The entry point for your FastAPI application.  
  *Why?* Defines the app instance, includes routers, and sets up middleware/events.

- **app/api/routes/**  
  Contains APIRouter modules for each resource (e.g., users).  
  *Why?* Keeps endpoints modular and organized.

- **app/db/**  
  Contains SQLAlchemy models, session management, and base class.  
  *Why?* Keeps all DB logic organized and reusable.

- **config/dev.env**  
  Stores environment variables for local development.  
  *Why?* Keeps secrets/config out of code and easy to change per environment.

- **tests/**  
  All test code lives here. `conftest.py` provides fixtures for test DB and client.  
  *Why?* Ensures your app is reliable and changes are safe.

- **requirements.txt**  
  Lists all dependencies for reproducible environments.

---

## 🚀 Getting Started

1. **Install dependencies**
   ```sh
   pip install -r requirements.txt
   ```

2. **Set up environment variables**
   - Copy `config/dev.env` to `.env` or use as is for local dev.

3. **Run database migrations**
   ```sh
   alembic upgrade head
   ```

4. **Start the app**
   ```sh
   uvicorn app.main:app --reload
   ```

5. **Run tests**
   ```sh
   pytest
   ```
